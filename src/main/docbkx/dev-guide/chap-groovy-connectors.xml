<?xml version="1.0" encoding="UTF-8"?>
<!--
  ! CCPL HEADER START
  !
  ! This work is licensed under the Creative Commons
  ! Attribution-NonCommercial-NoDerivs 3.0 Unported License.
  ! To view a copy of this license, visit
  ! http://creativecommons.org/licenses/by-nc-nd/3.0/
  ! or send a letter to Creative Commons, 444 Castro Street,
  ! Suite 900, Mountain View, California, 94041, USA.
  !
  ! You can also obtain a copy of the license at
  ! legal-notices/CC-BY-NC-ND.txt.
  ! See the License for the specific language governing permissions
  ! and limitations under the License.
  !
  ! If applicable, add the following below this CCPL HEADER, with the fields
  ! enclosed by brackets "[]" replaced with your own identifying information:
  !      Portions Copyright [yyyy] [name of copyright owner]
  !
  ! CCPL HEADER END
  !
  !      Copyright 2015 ForgeRock AS
  !
-->
<chapter xml:id='chap-groovy-connectors'
 xmlns='http://docbook.org/ns/docbook' version='5.0' xml:lang='en'
 xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
 xsi:schemaLocation='http://docbook.org/ns/docbook http://docbook.org/xml/5.0/xsd/docbook.xsd'
 xmlns:xlink='http://www.w3.org/1999/xlink'
 xmlns:xinclude='http://www.w3.org/2001/XInclude'>
 <title>Writing Scripted Connectors With the Groovy Connector Toolkit</title>

 <para>
  The Groovy Connector Toolkit enables you to run Groovy scripts to interact
  with any external resource.
 </para>
 <para>
  The Groovy Connector Toolkit is not a complete connector, in the traditional
  sense. Rather, it is a framework within which you must write your own Groovy
  scripts to address the requirements of your deployment. OpenICF and the
  OpenIDM project provide specific utilities to help you get started with the
  Groovy Connector Toolkit.
 </para>
 <para>
  The Groovy Connector Toolkit is bundled with OpenIDM ${openidmVersion}, and
  can also be downloaded from the <link xlink:show="new"
  xlink:href="http://maven.forgerock.org/repo/simple/releases/org/forgerock/openicf/connectors/groovy-connector/1.4.1.0">Forgerock
  Maven repository.</link>
 </para>
 <para>
  A number of deployment-specific scripts are provided in the samples that are
  delivered with OpenIDM. These scripts demonstrate how the Groovy Connector
  Toolkit can be used. The scripts cannot be used "as is" in your deployment,
  but can be used as a starting point on which to base your customization.
  OpenIDM also provides a custom connector bundler, that does much of the
  development work for you. For more information, see
  <link xlink:show="new" xlink:href="dev-guide#chap-custom-bundler"
  xlink:role="http://docbook.org/xlink/role/olink"><citetitle>Building
  Connectors With the Custom Scripted Connector Bundler</citetitle></link>.
 </para>
 <!--TODO Describe when Laszlo has done the archetype for this
 <para>
  This chapter describes how to use a Maven archetype for the Groovy Connector
  Toolkit, to build your own custom connector from scratch.
 </para> -->
 <para>
  The Groovy Connector Toolkit can be used with any OpenICF-enabled project
  (that is, any project in which the OpenICF Connector Framework is installed).
 </para>

 <section xml:id="about-groovy">
  <title>About the Groovy Scripting Language</title>
  <para>
   Groovy is a powerful, convenient scripting language for the Java platform.
   Groovy enables you to take advantage of existing Java resources, and
   generally makes development quicker. Syntactically, Groovy is similar to
   JavaScript. Extensive information about Groovy is available on the Groovy
   <link xlink:show="new"
   xlink:href="http://www.groovy-lang.org/documentation.html">documentation
   site</link>.
  </para>
 </section>

 <section xml:id="groovy-connector-types">
  <title>Selecting a Scripted Connector Implementation</title>
  <para>
   The Groovy Connector Toolkit provides five default connector implementations.
   These default implementations should address the requirements of most target
   resources. If you use one of the default implementations, you need only write
   the accompanying scripts, and point your connector to their location. If your
   target resource is not covered by the default implementations, you can use
   the Maven archetype to create a new connector project, and write a custom
   Groovy-based connector from scratch. <!--TODO link to Maven archetype -->
  </para>
  <para>
   The following list describes the default scripted connector implementations
   provided with the Groovy Connector Toolkit:
  </para>
  <itemizedlist>
   <listitem>
    <para>
     <literal>GROOVY</literal> - a basic non-pooled Groovy connector, provided
     in the
     <literal>org.forgerock.openicf.connectors.groovy.ScriptedConnector</literal>
     class.
    </para>
    <para>
     <literal>POOLABLEGROOVY</literal> - a poolable Groovy connector, provided
     in the
     <literal>org.forgerock.openicf.connectors.groovy.ScriptedPoolableConnector</literal>
     class.
    </para>
    <para>
     <literal>CREST</literal> - a connector based on the ForgeRock Commons
     REST (CREST) API, and provided in the
     <literal>org.forgerock.openicf.connectors.groovy.ScriptedCRESTConnector</literal>
     class. The scripted CREST connector takes a schema configuration file to
     define the attribute mapping from the OpenICF connector object to the
     CREST resource.
    </para>
    <para>
     <literal>REST</literal> -  a scripted REST connector, provided in the
     <literal>org.forgerock.openicf.connectors.groovy.ScriptedRESTConnector</literal>
     class. The scripted REST connector enables you to connect to any resource,
     over HTTP/REST. The connector creates the HTTP/REST context (specifying the
     content type, authentication mode, encoding, and so on), and manages the
     connection. The connector relies on the Groovy scripting language and its
     RESTClient package.
    </para>
    <para>
     <literal>SQL</literal> - a scripted SQL connector, provided in the
     <literal>org.forgerock.openicf.connectors.groovy.ScriptedSQLConnector</literal>
     class. The scripted SQL connector uses Groovy scripts to interact with a
     JDBC database.
    </para>
   </listitem>
  </itemizedlist>
  <para>
   When you have selected a scripted connector implementation, write the
   required scripts that correspond to that connector type.
   <xref linkend="implementing-operations" /> provides information and examples
   on how to write scripts for the basic scripted connector implementation, and
   information on the extensions available for the other implementations.
  </para>
 </section>

 <section xml:id="implementing-operations-groovy">
  <title>Implementing OpenICF Operations With Groovy Scripts</title>
  <para>
   The Groovy Connector Toolkit enables you to run a Groovy script for any
   OpenICF operation, such as search, update, create, and so forth, on any
   external resource.
  </para>
  <para>
   You must write a Groovy script that corresponds to each operation that your
   connector will support. For information about all the operations that are
   supported by the OpenICF framework, see <link xlink:show="new"
   xlink:href="dev-guide#chap-openicf-spi"
   xlink:role="http://docbook.org/xlink/role/olink"><citetitle>Implementing the
   OpenICF SPI</citetitle></link>.
  </para>
  <variablelist>
   <para>
    Your scripted connector can implement the following OpenICF interfaces:
   </para>
   <varlistentry>
    <term><link xlink:show="new" xlink:href="dev-guide#operation-authenticate"
    xlink:role="http://docbook.org/xlink/role/olink">Authenticate</link></term>
    <listitem>
     <para>
      Provides simple authentication with two parameters, presumed to be a user
      name and password.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><link xlink:show="new" xlink:href="dev-guide#operation-create"
    xlink:role="http://docbook.org/xlink/role/olink">Create</link></term>
    <listitem>
     <para>
      Creates an object and its <literal>uid</literal>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><link xlink:show="new" xlink:href="dev-guide#operation-delete"
    xlink:role="http://docbook.org/xlink/role/olink">Delete</link></term>
    <listitem>
     <para>
      Deletes an object, referenced by its <literal>uid</literal>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><link xlink:show="new" xlink:href="dev-guide#operation-resolve-username"
    xlink:role="http://docbook.org/xlink/role/olink">Resolve Username</link></term>
    <listitem>
     <para>
      Deletes an object, referenced by its <literal>uid</literal>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><link xlink:show="new" xlink:href="dev-guide#operation-schema"
    xlink:role="http://docbook.org/xlink/role/olink">Schema</link></term>
    <listitem>
     <para>
      Describes the object types, operations, and options that the connector supports.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><link xlink:show="new" xlink:href="dev-guide#operation-script-on-connector"
    xlink:role="http://docbook.org/xlink/role/olink">Script on Connector</link></term>
    <listitem>
     <para>
      Enables an application to run a script in the context of the connector.
      Any script that runs on the connector has the following characteristics:
     </para>
     <itemizedlist>
      <listitem>
       <para>
        The script runs in the same execution environment as the connector and
        has access to all the classes to which the connector has access.
       </para>
      </listitem>
      <listitem>
       <para>
        The script has access to a connector variable that is equivalent to an
        initialized instance of the connector. At a minimum, the script can
        access the connector configuration.
       </para>
      </listitem>
      <listitem>
       <para>
        The script has access to any script-arguments passed in by the
        application.
       </para>
      </listitem>
     </itemizedlist>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><link xlink:show="new" xlink:href="dev-guide#operation-script-on-resource"
    xlink:role="http://docbook.org/xlink/role/olink">Script on Resource</link></term>
    <listitem>
     <para>
      Runs a script on the target resource that is managed by the connector.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><link xlink:show="new" xlink:href="dev-guide#operation-search"
    xlink:role="http://docbook.org/xlink/role/olink">Search</link></term>
    <listitem>
     <para>
      Searches the target resource for all objects that match the specified
      object class and filter.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><link xlink:show="new" xlink:href="dev-guide#operation-sync"
    xlink:role="http://docbook.org/xlink/role/olink">Sync</link></term>
    <listitem>
     <para>
      Polls the target resource for synchronization events, that is, native
      changes to objects on the target resource.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><link xlink:show="new" xlink:href="dev-guide#operation-test"
    xlink:role="http://docbook.org/xlink/role/olink">Test</link></term>
    <listitem>
     <para>
      Tests the connector configuration. Testing a configuration checks that all
      elements of the environment that are referred to by the configuration are
      available. For example, the connector might make a physical connection to
      a host that is specified in the configuration to verify that it exists and
      that the credentials that are specified in the configuration are valid.
     </para>
     <para>
      This operation might need to connect to a resource, and, as such, might
      take some time. Do not invoke this operation too often, such as before
      every provisioning operation. The test operation is not intended to check
      that the connector is alive (that is, that its physical connection to the
      resource has not timed out).
     </para>
     <para>
      You can invoke the test operation before a connector configuration has
      been validated.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><link xlink:show="new" xlink:href="dev-guide#operation-update"
    xlink:role="http://docbook.org/xlink/role/olink">Update</link></term>
    <listitem>
     <para>
      Updates (modifies or replaces) objects on a target resource.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <para>
   The following sections provide more information and sample scripts for all
   the operations that are implemented in the Groovy Connector toolkit. Sample
   scripts are provided for the basic scripted connector implementation, with
   additional information provided for the remaining implementations.
  </para>

  <section xml:id="script-authenticate">
   <title>Writing a Groovy Authentication Script</title>
   <para>
    An authentication script is <emphasis>required</emphasis> in every connector
    implementation. If your connector does not need to authenticate to the
    resource, the authentication script should allow the
    <literal>authId</literal> to pass through by default.
   </para>
   <variablelist>
    <para>
     The following variables are available to the authentication script:
    </para>
    <varlistentry>
     <term>operation</term>
     <listitem>
      <para>
       The operation type is <literal>AUTHENTICATION</literal> for this script.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>configuration</term>
     <listitem>
      <para>
       The configuration class created for this connector. For the basic
       scripted connector, the configuration class is
       <literal>ScriptedConfiguration</literal>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>log</term>
     <listitem>
      <para>
       The default logging facility.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>objectClass</term>
     <listitem>
      <para>
       The object classes that are managed by the connector.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>options</term>
     <listitem>
      <para>
       Additional operation options supported by the connector.
      </para>
     </listitem>
    </varlistentry>

    <varlistentry>
     <term>username</term>
     <listitem>
      <para>
       A string that provides the username to authenticate.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>password</term>
     <listitem>
      <para>
       A guarded string that provides the password with which to authenticate.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    Sample <link xlink:href="../resources/AuthenticateScript.groovy"
    xlink:show="new">AuthenticateScript.groovy</link>.
   </para>

   <section xml:id="authenticate-script-extensions">
    <title>Authenticate Script Extensions</title>
    <para>
     In addition to the variables available to the basic scripted connector,
     the following variables are available to the extended connector
     implementations:
    </para>
    <variablelist>
     <varlistentry>
      <term>ScriptedREST Connector</term>
      <listitem>
       <para>
        <literal>httpClient</literal> and <literal>connection</literal>
        variables, to initiate the HTTP connection.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </section>
  </section>

 <section xml:id="script-test">
  <title>Writing a Groovy Test Script</title>
  <para>
   A test script tests the connection to the external resource to ensure that
   the other operations that are provided by the connector can succeed.
  </para>
  <variablelist>
   <para>
    The following variables are available to the test script:
   </para>
   <varlistentry>
    <term>operation</term>
    <listitem>
     <para>
      The operation type is <literal>TEST</literal> for this script.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>configuration</term>
    <listitem>
     <para>
      The configuration class created for this connector.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>log</term>
    <listitem>
     <para>
      The default logging facility.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   Sample <link xlink:href="../resources/TestScript.groovy"
   xlink:show="new">TestScript.groovy</link>.
  </para>

  <section xml:id="test-script-extensions">
   <title>Test Script Extensions</title>
   <para>
    In addition to the variables available to the basic scripted connector,
    the following variables are available to the extended connector
    implementations:
   </para>
   <variablelist>
    <varlistentry>
     <term>ScriptedREST Connector</term>
     <listitem>
      <para>
       <literal>httpClient</literal> and <literal>connection</literal>
       variables, to initiate the HTTP connection.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>ScriptedCREST Connector</term>
     <listitem>
      <para>
       <literal>connection</literal> variable, to initiate the HTTP connection.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>ScriptedSQL Connector</term>
     <listitem>
      <para>
       <literal>connection</literal> variable, to initiate the SQL connection.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </section>
 </section>

 <section xml:id="script-create">
  <title>Writing a Groovy Create Script</title>
  <para>
   A create script creates a new object on the external resource. If your
   connector does not support creating an object, this script should throw an
   <literal>UnsupportedOperationException</literal>. On success, the script
   should return a <literal>Uid</literal> object that represents the ID of the
   newly created object.
  </para>
  <variablelist>
   <para>
    The following variables are available to the create script:
   </para>
   <varlistentry>
    <term>operation</term>
    <listitem>
     <para>
      The operation type is <literal>CREATE</literal> for this script.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>configuration</term>
    <listitem>
     <para>
      The configuration class created for this connector.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>log</term>
    <listitem>
     <para>
      The default logging facility.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>createAttributes</term>
    <listitem>
     <para>
      The set of attributes that describe the object to be created.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>uid</term>
    <listitem>
     <para>
      The UID of the object to be created, if specified. If the UID is
      <literal>null</literal>, the UID should be generated by the server.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>objectClass</term>
    <listitem>
     <para>
      The objectClass of the object to be created, for example,
      <literal>ACCOUNT</literal> or <literal>GROUP</literal>.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   Sample <link xlink:href="../resources/CreateScript.groovy"
   xlink:show="new">CreateScript.groovy</link>.
  </para>
 </section>

 <section xml:id="script-search">
  <title>Writing a Groovy Search Script</title>
  <para>
   A search script searches for one or more objects on the external resource.
   Connectors that do not support searches should throw an
   <literal>UnsupportedOperationException</literal>. A search script should
   use the <literal>handler</literal> object to process the result set
  </para>
  <variablelist>
   <para>
    The following variables are available to the search script:
   </para>
   <varlistentry>
    <term>operation</term>
    <listitem>
     <para>
      The operation type is <literal>SEARCH</literal> for this script.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>configuration</term>
    <listitem>
     <para>
      The configuration class created for this connector.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>log</term>
    <listitem>
     <para>
      The default logging facility.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>objectClass</term>
    <listitem>
     <para>
      The objectClass of the object to be searched, for example,
      <literal>ACCOUNT</literal> or <literal>GROUP</literal>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>filter</term>
    <listitem>
     <para>
      The search filter for this operation.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>options</term>
    <listitem>
     <para>
      Additional options for this operation.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   Sample <link xlink:href="../resources/SearchScript.groovy"
   xlink:show="new">SearchScript.groovy</link>.
  </para>
 </section>

 <section xml:id="script-update">
  <title>Writing a Groovy Update Script</title>
  <para>
   An update script updates an object in the external source. Connectors that do
   not support update operations should throw an
   <literal>UnsupportedOperationException</literal>. An update script must
   return the <literal>uid</literal> of the updated object.
  </para>
  <variablelist>
   <para>
    The following variables are available to the update script:
   </para>
   <varlistentry>
    <term>operation</term>
    <listitem>
     <para>
      The operation type is <literal>UPDATE</literal> for this script.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>configuration</term>
    <listitem>
     <para>
      The configuration class created for this connector.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>log</term>
    <listitem>
     <para>
      The default logging facility.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>updateAttributes</term>
    <listitem>
     <para>
      The set of attributes that describe the object to be updated.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>uid</term>
    <listitem>
     <para>
      The UID of the object to be updated.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>objectClass</term>
    <listitem>
     <para>
      The objectClass of the object to be updated, for example,
      <literal>ACCOUNT</literal> or <literal>GROUP</literal>.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   Sample <link xlink:href="../resources/UpdateScript.groovy"
   xlink:show="new">UpdateScript.groovy</link>.
  </para>
 </section>

 <section xml:id="script-delete">
  <title>Writing a Groovy Delete Script</title>
  <para>
   A delete script deletes an object in the external resource. Connectors that
   do not support delete operations should throw an
   <literal>UnsupportedOperationException</literal>. This script has no return
   value but should throw an exception if the delete is unsuccessful for any
   reason.
  </para>
  <variablelist>
   <para>
    The following variables are available to the delete script:
   </para>
   <varlistentry>
    <term>operation</term>
    <listitem>
     <para>
      The operation type is <literal>DELETE</literal> for this script.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>configuration</term>
    <listitem>
     <para>
      The configuration class created for this connector.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>log</term>
    <listitem>
     <para>
      The default logging facility.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>uid</term>
    <listitem>
     <para>
      The UID of the object to be deleted.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>objectClass</term>
    <listitem>
     <para>
      The objectClass of the object to be deleted, for example,
      <literal>ACCOUNT</literal> or <literal>GROUP</literal>.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   Sample <link xlink:href="../resources/DeleteScript.groovy"
   xlink:show="new">DeleteScript.groovy</link>.
  </para>
 </section>

 <section xml:id="script-sync">
  <title>Writing a Groovy Synchronization Script</title>
  <para>
   A synchronization script synchronizes objects between two resources. The
   script should retrieve all objects in the external resource that have been
   updated since some defined token. The script should use the
   <literal>handler</literal> object to process the result set.
  </para>
  <variablelist>
   <para>
    The following variables are available to the sync script:
   </para>
   <varlistentry>
    <term>operation</term>
    <listitem>
     <para>
      The operation type for this script is <literal>SYNC</literal> or
      <literal>GET_LATEST_SYNC_TOKEN</literal>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>configuration</term>
    <listitem>
     <para>
      The configuration class created for this connector.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>log</term>
    <listitem>
     <para>
      The default logging facility.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>objectClass</term>
    <listitem>
     <para>
      The objectClass of object to be created, for example,
      <literal>ACCOUNT</literal> or <literal>GROUP</literal>.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   Sample <link xlink:href="../resources/SyncScript.groovy"
   xlink:show="new">SyncScript.groovy</link>.
  </para>
 </section>

 <section xml:id="script-schema">
  <title>Writing a Groovy Schema Script</title>
  <para>
   A schema script builds the schema for the connector, either from a static,
   predefined schema, or by reading the schema from the external resource. The
   script should use the <literal>builder</literal> object to create the schema.
  </para>
  <variablelist>
   <para>
    The following variables are available to the create script:
   </para>
   <varlistentry>
    <term>operation</term>
    <listitem>
     <para>
      The operation type is <literal>SCHEMA</literal> for this script.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>configuration</term>
    <listitem>
     <para>
      The configuration class created for this connector.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>log</term>
    <listitem>
     <para>
      The default logging facility.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>builder</term>
    <listitem>
     <para>
      The schema builder object.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   Sample <link xlink:href="../resources/SchemaScript.groovy"
   xlink:show="new">SchemaScript.groovy</link>.
  </para>
 </section>
 </section>

 <section xml:id="advanced-custom-config">
  <title>Advanced - Customizing the Configuration Initialization</title>
  <para>
   Connectors created with the Groovy Connector Toolkit are, by default,
   stateful connectors. This means that the connector configuration instance is
   created only once.
  </para>
  <para>
   The Groovy Connector Toolkit is precompiled code, and connector
   configurations are initialized in a specific way. If you have specific
   initialization requirements, you can customize the way in which the connector
   configuration instance is initialized, before the first script is evaluated.
   The <filename>CustomizerScript.groovy</filename> file enables you to define
   custom closures to interact with the default implementation.
  </para>
  <para>
   The <filename>CustomizerScript.groovy</filename> file, provided with each
   compiled connector implementation, defines closures, such as
   <literal>init {}</literal>, <literal>decorate {}</literal>, and
   <literal>destroy {}</literal>. These closures are called during the lifecycle
   of the configuration.
  </para>
  <para>
   When you unpack the Groovy Connector Toolkit JAR file, the
   <filename>CustomizerScript.groovy</filename> file is located at
   <filename>org/forgerock/openicf/connectors/<replaceable>connector-implementation</replaceable></filename>.
  </para>
 </section>

</chapter>
